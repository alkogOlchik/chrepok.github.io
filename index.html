<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wealth IQ - Распознавание клиентов</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <!-- Подключаем наши скрипты -->
    <link rel="stylesheet" href="styles.css">
    <script src="python-code.js" defer></script>
    <script src="pdf-processor.js" defer></script>
    <script src="excel-processor.js" defer></script>
    <script src="app.js" defer></script>

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Wealth IQ - Система распознавания клиентов</h1>
        </div>

        <div class="content">
            <!-- Левая панель -->
            <div class="panel">
                <div class="panel-title">База клиентов</div>
                <div class="form-group">
                    <label>Колонка с именами:</label>
                    <input type="text" id="nameColumn" value="Название">
                </div>
                <div class="form-group">
                    <label>Колонка с ID:</label>
                    <input type="text" id="idColumn" value="Client ID">
                </div>
                <div class="form-group">
                    <label>Колонка с Ответственным:</label>
                    <input type="text" id="saleColumn" value="Ответственный">
                </div>
                <div class="form-group">
                    <input type="file" id="clientsFile" accept=".xlsx,.xls,.csv" style="display: none;">
                    <button onclick="document.getElementById('clientsFile').click()">Выбрать файл с клиентами</button>
                    <div id="clientsFileInfo" class="file-info">Файл не выбран</div>
                </div>
                <div id="clientsPreview" class="preview-area hidden"></div>
            </div>

            <!-- Остальные панели остаются такими же -->
            <div class="panel">
                <div class="panel-title">Параметры обработки</div>
                <div class="form-group">
                    <label>Квартал:</label>
                    <div class="radio-group">
                        <label class="radio-label"><input type="radio" name="quarter" value="1" checked> 1 квартал</label>
                        <label class="radio-label"><input type="radio" name="quarter" value="2"> 2 квартал</label>
                        <label class="radio-label"><input type="radio" name="quarter" value="3"> 3 квартал</label>
                        <label class="radio-label"><input type="radio" name="quarter" value="4"> 4 квартал</label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Партнер:</label>
                    <select id="partner">
                        <option>ЗАО Ардшинбанк</option>
                        <option>ОАО Армброк</option>
                        <option>АО Финам</option>
                        <option>ЗАО «Мета-Икс Маркетс»</option>
                        <option>QR</option>
                        <option>ТТА</option>
                    </select>
                </div>
            </div>

            <div class="panel">
                <div class="panel-title">Зашифрованные клиенты</div>
                <div id="formatInfo" class="file-info">Выберите партнера</div>
                <div class="form-group">
                    <input type="file" id="encryptedFile" accept=".xlsx,.xls,.pdf,.txt,.csv" style="display: none;">
                    <button onclick="document.getElementById('encryptedFile').click()">Загрузить из файла</button>
                    <div id="encryptedFileInfo" class="file-info">Файл не выбран</div>
                </div>
                <div class="form-group">
                    <label>Или введите данные вручную:</label>
                    <textarea id="manualInput" placeholder="Введите зашифрованные имена клиентов, каждое с новой строки" style="height: 100px;"></textarea>
                    <button onclick="useManualInput()">Использовать ручной ввод</button>
                </div>
                <div id="previewSection" class="hidden">
                    <div class="panel-title">Предпросмотр данных</div>
                    <div id="dataPreview" class="preview-area"></div>
                </div>
            </div>

            <div class="panel">
                <div class="panel-title">Действия</div>
                <button id="processBtn" onclick="processData()" disabled>Запустить распознавание</button>
                <button id="saveBtn" onclick="saveResults()" disabled>Скачать результаты</button>
            </div>

            <!-- Правая панель -->
            <div class="panel right-panel">
                <div class="panel-title">Статус обработки</div>
                <div id="status" class="status ready">Ожидание данных...</div>
                <div id="progressBar" class="progress-bar hidden">
                    <div class="progress-fill" style="width: 0%"></div>
                </div>

                <div class="panel-title">Результаты распознавания</div>
                <div style="overflow-x: auto;">
                    <table class="results-table" id="resultsTable">
                        <thead>
                            <tr>
                                <th>Зашифрованный клиент</th>
                                <th>Плательщик</th>
                                <th>Client ID</th>
                                <th>Ответственный</th>
                                <th>Уверенность</th>
                                <th>Метод</th>
                            </tr>
                        </thead>
                        <tbody id="resultsBody">
                            <tr><td colspan="6" style="text-align: center;">Нет данных</td></tr>
                        </tbody>
                    </table>
                </div>
                <div id="stats" class="file-info">Загрузите данные и запустите обработку</div>
            </div>
        </div>
    </div>
</body>
</html>